---
import Footer from '../../components/Footer.astro';
import FooterRights from '../../components/FooterRights.astro';
import { langs, type ui } from '../../i18n/ui';
import { useTranslations } from '../../i18n/utils'
import Layout from '../../layouts/Layout.astro' 


export function getStaticPaths () {
	return langs.map((lang) => ({
		params: { lang },
	}))
};

const {lang}  = Astro.params;
const t = useTranslations(lang as keyof typeof ui);
---

<Layout lang={lang} pageTitle={t('meta', 'title_contact_page')}
	pageDescription={t('meta', 'page_description_contact')}>
    <main class="w-full bg-input px-6 py-12">
      <div class="max-w-7xl mx-auto rounded-md ">
        <div class="text-center rounded-xl py-4 bg-background mb-12 services-header">
          <h2 class="font-playfair text-[clamp(2rem,5vw,3rem)] text-[color:var(--color-text-acika-primary)] mb-2 font-bold">
            {t('nav', 'contact')}
          </h2>
          <p class="text-[color:var(--color-text-acika-secondary)] text-[1.1rem] max-w-[600px] mx-auto">
            {t('meta', 'page_description_contact')}
          </p>
        </div>

        <!-- Contact Form -->
        <div class="bg-bg-acika-secondary rounded-lg border border-[color:var(--color-border)] p-8 shadow-sm">
          <form method="POST" id="contactForm" class="space-y-6">
            <!-- Email Input -->
            <div class="space-y-2">
              <label for="email" class="block text-sm font-medium text-[color:var(--color-text-acika-primary)]">
                {t('contact', 'email_address')}
              </label>
              <input
                id="email"
                name="email"
                type="email"
                required
                placeholder="your.email@example.com"
                class="w-full px-4 py-2 border border-[color:var(--color-input)] rounded-lg bg-[color:var(--color-background)] text-[color:var(--color-text-acika-primary)] focus:outline-none focus:ring-2 focus:ring-[color:var(--color-ring)]"
              />
            </div>

            <!-- Subject Input -->
            <div class="space-y-2">
              <label for="subject" class="block text-sm font-medium text-[color:var(--color-text-acika-primary)]">
               {t('contact', 'subject')}
              </label>
              <input
                id="subject"
                name="subject"
                type="text"
                required
                placeholder={t('contact', 'subject_placeholder')}
                class="w-full px-4 py-2 border border-[color:var(--color-input)] rounded-lg bg-[color:var(--color-background)] text-[color:var(--color-text-acika-primary)] focus:outline-none focus:ring-2 focus:ring-[color:var(--color-ring)]"
              />
            </div>

            <!-- Message Body -->
            <div class="space-y-2">
              <label for="body" class="block text-sm font-medium text-[color:var(--color-text-acika-primary)]">
                {t('contact', 'message')}
              </label>
              <textarea
                id="body"
                name="message"
                required
                placeholder={t('contact', 'message_placeholder')}
                rows="6"
                class="w-full px-4 py-2 border border-[color:var(--color-input)] rounded-lg bg-[color:var(--color-background)] text-[color:var(--color-text-acika-primary)] focus:outline-none focus:ring-2 focus:ring-[color:var(--color-ring)] resize-none"
              ></textarea>
            </div>

            <!-- Submit Button -->
            <div class="pt-4">
              <button
                type="submit"
                id='submit-btn'
                class="w-full bg-[color:var(--color-primary)] hover:bg-[color:var(--color-primary)]/90 text-[color:var(--color-primary-foreground)] py-3 rounded-lg font-medium transition"
              >
                {t('contact', 'send_message')}
              </button>
            </div>
          </form>
        </div>
      </div>
    </main>
	<Footer/>
	<FooterRights/>
</Layout>

<script>
  const submitBtn = document.getElementById('submit-btn');
  const contactForm = document.getElementById('contactForm');

  // Ensure we have the right element types so TypeScript/JS knows `disabled` exists
  if (!(submitBtn instanceof HTMLButtonElement) || !(contactForm instanceof HTMLFormElement)) {
    throw new Error('Contact form or submit button not found or of wrong type');
  }

  contactForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    submitBtn.disabled = true;
    submitBtn.textContent = 'Sending...';

    const formData = new FormData(contactForm);
    const data = {
      email: formData.get('email'),
      subject: formData.get('subject'),
      message: formData.get('message'),
    };

    try {
      const response = await fetch('https://api.salonacika.com', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(data),
      });

      if (response.ok) {
        alert('Your message has been sent successfully!');
        contactForm.reset();
      } else {
        alert('There was an error sending your message. Please try again later.');
      }
    } catch (error) {
      alert('There was an error sending your message. Please try again later.');
    } finally {
      submitBtn.disabled = false;
      submitBtn.textContent = 'Send Message';
    }
  });
</script>